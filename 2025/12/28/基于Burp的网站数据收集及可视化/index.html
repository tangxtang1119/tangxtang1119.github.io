<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta name="description" content="‘有志少女 先读书’" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>基于Burp的网站数据收集及可视化 |  tangxtang</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/favicon.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-基于Burp的网站数据收集及可视化"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  基于Burp的网站数据收集及可视化
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2025/12/28/%E5%9F%BA%E4%BA%8EBurp%E7%9A%84%E7%BD%91%E7%AB%99%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86%E5%8F%8A%E5%8F%AF%E8%A7%86%E5%8C%96/" class="article-date">
  <time datetime="2025-12-27T16:00:00.000Z" itemprop="datePublished">2025-12-28</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">4.5k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">21 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <p><strong>作业记录</strong></p>
<p>本流程覆盖 “环境搭建→本地网站部署→数据采集→数据存储→数据清洗→可视化→成果验证” 全环节</p>
<h3 id="前置准备：工具-软件清单"><a href="#前置准备：工具-软件清单" class="headerlink" title="前置准备：工具 &#x2F; 软件清单"></a>前置准备：工具 &#x2F; 软件清单</h3><p>提前安装以下工具，版本匹配建议：</p>
<ol>
<li>Python 3.7+（推荐 3.9）：<a target="_blank" rel="noopener" href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></li>
<li>MySQL 5.7&#x2F;8.0 + Navicat（可视化管理）：MySQL 官网下载社区版，Navicat 选免费版 &#x2F; 试用版</li>
<li>Burp Suite Community（抓包工具）：<a target="_blank" rel="noopener" href="https://portswigger.net/burp/communitydownload">https://portswigger.net/burp/communitydownload</a></li>
<li>Kettle 9.4（数据清洗）：<a target="_blank" rel="noopener" href="https://community.hitachivantara.com/s/article/data-integration-pentaho-data-integration">https://community.hitachivantara.com/s/article/data-integration-pentaho-data-integration</a></li>
<li>Anaconda（可选，创建独立虚拟环境）：<a target="_blank" rel="noopener" href="https://www.anaconda.com/download">https://www.anaconda.com/download</a></li>
<li>PyCharm（可选，代码编辑）：<a target="_blank" rel="noopener" href="https://www.jetbrains.com/pycharm/download/">https://www.jetbrains.com/pycharm/download/</a></li>
</ol>
<h3 id="搭建独立-Python-虚拟环境（避免依赖冲突）"><a href="#搭建独立-Python-虚拟环境（避免依赖冲突）" class="headerlink" title="搭建独立 Python 虚拟环境（避免依赖冲突）"></a>搭建独立 Python 虚拟环境（避免依赖冲突）</h3><p>打开 Anaconda Prompt（无 Anaconda 则打开 CMD&#x2F;PowerShell）：</p>
<ul>
<li>（Anaconda）创建环境：<code>conda create -n burp_data python=3.9</code>，按提示输入<code>y</code>确认</li>
<li>激活环境：<code>conda activate burp_data</code>（终端前缀出现<code>(burp_data)</code>即成功）</li>
</ul>
<p>安装 Python 依赖库：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install flask pandas matplotlib pymysql  <span class="comment"># 核心依赖，一键安装</span></span><br></pre></td></tr></table></figure>

<p>验证：执行<code>pip list</code>，能看到 flask、pandas、matplotlib、pymysql 均在列表中，版本无报错即可。</p>
<h3 id="部署本地测试网站（数据源）"><a href="#部署本地测试网站（数据源）" class="headerlink" title="部署本地测试网站（数据源）"></a>部署本地测试网站（数据源）</h3><p>新建项目文件夹（如<code>burp_test_site</code>），结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">burp_test_site/</span><br><span class="line">├─ app.py （后端脚本）</span><br><span class="line">├─ static/ （可选，放样式，无则忽略）</span><br><span class="line">└─ templates/</span><br><span class="line">   └─ index.html （首页模板）</span><br></pre></td></tr></table></figure>

<p>用 PyCharm 打开该文件夹，选择解释器为<code>burp_data</code>虚拟环境（File→Settings→Python Interpreter）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.html代码 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>模拟电商商品页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入Bootstrap CDN（无需本地安装） --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.goods-card</span> &#123; <span class="attribute">margin</span>: <span class="number">20px</span> <span class="number">0</span>; <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.1</span>); &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.header</span> &#123; <span class="attribute">background-color</span>: <span class="number">#0d6efd</span>; <span class="attribute">color</span>: white; <span class="attribute">padding</span>: <span class="number">20px</span>; <span class="attribute">text-align</span>: center; <span class="attribute">margin-bottom</span>: <span class="number">30px</span>; &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>模拟电商商品展示平台<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>基于Flask+Bootstrap搭建的测试网站<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            &#123;% for good in goods %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card goods-card&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;card-title&quot;</span>&gt;</span>&#123;&#123; good.name or &#x27;未命名商品&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text&quot;</span>&gt;</span>价格：¥&#123;&#123; good.price &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text&quot;</span>&gt;</span>库存：&#123;&#123; good.stock &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text&quot;</span>&gt;</span>分类：&#123;&#123; good.category or &#x27;未分类&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;card-text&quot;</span>&gt;</span>销量：&#123;&#123; good.sales &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>查看详情<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>运行app.py:</p>
<ul>
<li>终端执行：<code>python app.py</code></li>
<li>看到终端输出<code>Running on http://127.0.0.1:5000/</code>即启动成功。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment"># 模拟商品数据（包含空值、0值、无效值，用于后续清洗）</span></span><br><span class="line">goods_data = [</span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;华为Mate70&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">6999</span>, <span class="string">&quot;stock&quot;</span>: <span class="number">100</span>, <span class="string">&quot;category&quot;</span>: <span class="string">&quot;手机&quot;</span>, <span class="string">&quot;sales&quot;</span>: <span class="number">500</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>: <span class="number">2</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;苹果iPhone16&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">0</span>, <span class="string">&quot;stock&quot;</span>: <span class="number">80</span>, <span class="string">&quot;category&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;sales&quot;</span>: <span class="number">300</span>&#125;,  <span class="comment"># price=0，category空值</span></span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>: <span class="number">3</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">2999</span>, <span class="string">&quot;stock&quot;</span>: -<span class="number">5</span>, <span class="string">&quot;category&quot;</span>: <span class="string">&quot;平板&quot;</span>, <span class="string">&quot;sales&quot;</span>: <span class="number">0</span>&#125;,          <span class="comment"># name空，stock无效，sales=0</span></span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>: <span class="number">4</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;小米Pad6&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">2499</span>, <span class="string">&quot;stock&quot;</span>: <span class="number">200</span>, <span class="string">&quot;category&quot;</span>: <span class="string">&quot;平板&quot;</span>, <span class="string">&quot;sales&quot;</span>: <span class="number">150</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;id&quot;</span>: <span class="number">5</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;vivo X200&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">4599</span>, <span class="string">&quot;stock&quot;</span>: <span class="number">0</span>, <span class="string">&quot;category&quot;</span>: <span class="string">&quot;手机&quot;</span>, <span class="string">&quot;sales&quot;</span>: <span class="number">200</span>&#125; <span class="comment"># stock=0]</span></span><br><span class="line"><span class="comment"># 首页（商品列表，美化后）@app.route(&#x27;/&#x27;)def index():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, goods=goods_data)</span><br><span class="line"><span class="comment"># 商品详情页@app.route(&#x27;/detail/&lt;int:goods_id&gt;&#x27;)def detail(goods_id):</span></span><br><span class="line">    good = <span class="built_in">next</span>((g <span class="keyword">for</span> g <span class="keyword">in</span> goods_data <span class="keyword">if</span> g[<span class="string">&#x27;id&#x27;</span>] == goods_id), <span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;detail.html&#x27;</span>, good=good)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, port=<span class="number">5000</span>)  <span class="comment"># 本地启动，访问http://127.0.0.1:5000</span></span><br></pre></td></tr></table></figure>

<p>验证：打开浏览器访问<code>http://127.0.0.1:5000</code>，能看到带商品列表的美化页面，包含异常值（如 “未命名商品”、库存 - 5 等）效果图如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228230745369.png"></p>
<h3 id="Burp-抓包采集网站数据"><a href="#Burp-抓包采集网站数据" class="headerlink" title="Burp 抓包采集网站数据"></a>Burp 抓包采集网站数据</h3><ol>
<li><p>Burp 代理配置：</p>
<ul>
<li>启动 Burp Suite，选 “Temporary project”→“Next”→“Start Burp”。</li>
<li>点击<code>Proxy→Options→Add</code>，端口填 8080，勾选<code>Loopback only</code>（仅抓本地请求），点击<code>OK</code>，确保代理状态为 “Running”。</li>
</ul>
</li>
<li><p>浏览器代理配置：</p>
</li>
</ol>
<ul>
<li>Chrome&#x2F;Edge：设置→高级→系统→打开计算机代理设置→手动设置代理，地址填<code>127.0.0.1</code>，端口<code>8080</code>，勾选 “对所有协议使用相同代理”，保存。</li>
</ul>
<ol start="3">
<li>抓包并导出数据：</li>
</ol>
<ul>
<li><p>浏览器刷新<code>http://127.0.0.1:5000</code>，回到 Burp→<code>Proxy→HTTP history</code>，筛选 URL 含<code>/</code>的 GET 请求（目标请求）。</p>
<p>  <img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228231124456.png"></p>
</li>
<li><p>选中该请求，右键→<code>Save items</code>，保存类型选<code>XML</code>，文件名<code>burp_requests.xml</code>，保存到<code>burp_test_site</code>文件夹。</p>
</li>
</ul>
<ol start="4">
<li>解析 XML 为 CSV：</li>
</ol>
<ul>
<li><p>将<code>xml_to_json.py</code>复制到<code>burp_test_site</code>文件夹。</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Burp XML商品数据提取脚本</span></span><br><span class="line"><span class="string">功能：解析Burp导出的XML文件，提取商品信息并转为CSV格式</span></span><br><span class="line"><span class="string">适配场景：从本地Burp XML文件中提取商品数据，无需预处理和自动导入数据库</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------------- 1. 本地日志初始化 --------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_logger</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;初始化本地日志，仅保存到本地文件&quot;&quot;&quot;</span></span><br><span class="line">    logger = logging.getLogger(<span class="string">&quot;burp_goods_extract&quot;</span>)</span><br><span class="line">    logger.setLevel(logging.INFO)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> logger.handlers:</span><br><span class="line">        <span class="comment"># 同时输出到控制台和文件</span></span><br><span class="line">        console_handler = logging.StreamHandler()</span><br><span class="line">        console_handler.setLevel(logging.INFO)</span><br><span class="line"></span><br><span class="line">        file_handler = logging.FileHandler(<span class="string">&quot;goods_extract.log&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        file_handler.setLevel(logging.INFO)</span><br><span class="line"></span><br><span class="line">        formatter = logging.Formatter(</span><br><span class="line">            <span class="string">&quot;%(asctime)s - %(levelname)s - %(message)s&quot;</span>,</span><br><span class="line">            datefmt=<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span></span><br><span class="line">        )</span><br><span class="line">        console_handler.setFormatter(formatter)</span><br><span class="line">        file_handler.setFormatter(formatter)</span><br><span class="line"></span><br><span class="line">        logger.addHandler(console_handler)</span><br><span class="line">        logger.addHandler(file_handler)</span><br><span class="line">    <span class="keyword">return</span> logger</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">logger = init_logger()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------------- 2. 解析Burp XML文件（核心：提取商品信息） --------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_burp_xml_goods</span>(<span class="params">xml_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    解析Burp导出的XML文件，提取商品信息</span></span><br><span class="line"><span class="string">    :param xml_path: 本地XML文件路径</span></span><br><span class="line"><span class="string">    :return: 商品数据列表（字典）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    goods_data = []</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tree = ET.parse(xml_path)</span><br><span class="line">        root = tree.getroot()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 遍历Burp XML的item节点</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> root.findall(<span class="string">&quot;.//item&quot;</span>):</span><br><span class="line">            response = item.find(<span class="string">&quot;response&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> response <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> response.text:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="comment"># 解码base64响应内容为完整页面HTML</span></span><br><span class="line">                    response_html = base64.b64decode(response.text).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">                    logger.info(<span class="string">&quot;HTML解码成功，开始提取商品信息&quot;</span>)</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    logger.warning(<span class="string">f&quot;响应解码失败：<span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># 更健壮的提取方式：直接在整个HTML中搜索商品信息</span></span><br><span class="line">                <span class="comment"># 首先，提取所有商品名称</span></span><br><span class="line">                names = re.findall(<span class="string">r&#x27;&lt;h5 class=&quot;card-title&quot;&gt;([^&lt;]+)&lt;/h5&gt;&#x27;</span>, response_html)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 提取所有价格</span></span><br><span class="line">                prices = re.findall(<span class="string">r&#x27;价格：¥(\d+)&#x27;</span>, response_html)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 提取所有库存</span></span><br><span class="line">                stocks = re.findall(<span class="string">r&#x27;库存：([^&lt;]+)&lt;/p&gt;&#x27;</span>, response_html)</span><br><span class="line">                <span class="comment"># 清理库存数据，只保留数字部分</span></span><br><span class="line">                stocks_clean = []</span><br><span class="line">                <span class="keyword">for</span> stock <span class="keyword">in</span> stocks:</span><br><span class="line">                    <span class="comment"># 提取数字部分，包括可能的负号</span></span><br><span class="line">                    stock_match = re.search(<span class="string">r&#x27;(-?\d+)&#x27;</span>, stock)</span><br><span class="line">                    stocks_clean.append(stock_match.group(<span class="number">1</span>) <span class="keyword">if</span> stock_match <span class="keyword">else</span> <span class="string">&quot;0&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 提取所有分类</span></span><br><span class="line">                categories = re.findall(<span class="string">r&#x27;分类：([^&lt;]+)&lt;/p&gt;&#x27;</span>, response_html)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 提取所有销量</span></span><br><span class="line">                sales = re.findall(<span class="string">r&#x27;销量：(\d+)&#x27;</span>, response_html)</span><br><span class="line"></span><br><span class="line">                logger.info(</span><br><span class="line">                    <span class="string">f&quot;提取到字段数量：名称<span class="subst">&#123;<span class="built_in">len</span>(names)&#125;</span>个，价格<span class="subst">&#123;<span class="built_in">len</span>(prices)&#125;</span>个，库存<span class="subst">&#123;<span class="built_in">len</span>(stocks_clean)&#125;</span>个，分类<span class="subst">&#123;<span class="built_in">len</span>(categories)&#125;</span>个，销量<span class="subst">&#123;<span class="built_in">len</span>(sales)&#125;</span>个&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 取最小长度，避免索引越界</span></span><br><span class="line">                min_len = <span class="built_in">min</span>(<span class="built_in">len</span>(names), <span class="built_in">len</span>(prices), <span class="built_in">len</span>(stocks_clean), <span class="built_in">len</span>(categories), <span class="built_in">len</span>(sales))</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(min_len):</span><br><span class="line">                    <span class="comment"># 构建商品数据字典</span></span><br><span class="line">                    goods_data.append(&#123;</span><br><span class="line">                        <span class="string">&quot;id&quot;</span>: <span class="built_in">str</span>(i + <span class="number">1</span>),</span><br><span class="line">                        <span class="string">&quot;name&quot;</span>: names[i].strip(),</span><br><span class="line">                        <span class="string">&quot;price&quot;</span>: prices[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(prices) <span class="keyword">else</span> <span class="string">&quot;0&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;stock&quot;</span>: stocks_clean[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(stocks_clean) <span class="keyword">else</span> <span class="string">&quot;0&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;category&quot;</span>: categories[i].strip() <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(categories) <span class="keyword">else</span> <span class="string">&quot;未分类&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;sales&quot;</span>: sales[i] <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(sales) <span class="keyword">else</span> <span class="string">&quot;0&quot;</span></span><br><span class="line">                    &#125;)</span><br><span class="line">                    logger.debug(</span><br><span class="line">                        <span class="string">f&quot;提取商品：名称=<span class="subst">&#123;names[i].strip()&#125;</span>, 价格=<span class="subst">&#123;prices[i]&#125;</span>, 库存=<span class="subst">&#123;stocks_clean[i]&#125;</span>, 分类=<span class="subst">&#123;categories[i]&#125;</span>, 销量=<span class="subst">&#123;sales[i]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">f&quot;解析完成：从XML提取<span class="subst">&#123;<span class="built_in">len</span>(goods_data)&#125;</span>条商品记录（文件：<span class="subst">&#123;xml_path&#125;</span>）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        logger.error(<span class="string">f&quot;Burp XML文件不存在：<span class="subst">&#123;xml_path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logger.error(<span class="string">f&quot;XML解析失败：<span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> goods_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------------- 3. 商品数据转CSV --------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">goods2csv</span>(<span class="params">data, csv_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将提取的商品数据转换为CSV文件</span></span><br><span class="line"><span class="string">    :param data: 商品数据列表</span></span><br><span class="line"><span class="string">    :param csv_path: CSV文件路径</span></span><br><span class="line"><span class="string">    :return: 是否成功</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        logger.warning(<span class="string">&quot;无商品数据，CSV转换终止&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 定义CSV字段名</span></span><br><span class="line">        fieldnames = [<span class="string">&quot;id&quot;</span>, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;price&quot;</span>, <span class="string">&quot;stock&quot;</span>, <span class="string">&quot;category&quot;</span>, <span class="string">&quot;sales&quot;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(csv_path, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>, newline=<span class="string">&quot;&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            writer = csv.DictWriter(f, fieldnames=fieldnames)</span><br><span class="line">            writer.writeheader()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 写入所有商品数据</span></span><br><span class="line">            <span class="keyword">for</span> goods <span class="keyword">in</span> data:</span><br><span class="line">                writer.writerow(goods)</span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">f&quot;商品数据转CSV完成，输出文件：<span class="subst">&#123;csv_path&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logger.error(<span class="string">f&quot;CSV转换失败：<span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------------- 4. 显示表格格式的结果 --------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">display_table</span>(<span class="params">goods_data, max_display=<span class="number">5</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;以表格形式显示商品信息&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> goods_data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;未提取到商品数据&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">65</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;提取的商品信息（表格格式）&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">65</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 表头</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="string">&#x27;序号&#x27;</span>:&lt;<span class="number">4</span>&#125;</span> <span class="subst">&#123;<span class="string">&#x27;商品名称&#x27;</span>:&lt;<span class="number">20</span>&#125;</span> <span class="subst">&#123;<span class="string">&#x27;价格&#x27;</span>:&lt;<span class="number">8</span>&#125;</span> <span class="subst">&#123;<span class="string">&#x27;库存&#x27;</span>:&lt;<span class="number">6</span>&#125;</span> <span class="subst">&#123;<span class="string">&#x27;销量&#x27;</span>:&lt;<span class="number">6</span>&#125;</span> <span class="subst">&#123;<span class="string">&#x27;分类&#x27;</span>:&lt;<span class="number">10</span>&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">65</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 显示数据</span></span><br><span class="line">    <span class="keyword">for</span> i, goods <span class="keyword">in</span> <span class="built_in">enumerate</span>(goods_data[:max_display], <span class="number">1</span>):</span><br><span class="line">        name = goods[<span class="string">&#x27;name&#x27;</span>][:<span class="number">18</span>] <span class="keyword">if</span> <span class="built_in">len</span>(goods[<span class="string">&#x27;name&#x27;</span>]) &gt; <span class="number">18</span> <span class="keyword">else</span> goods[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        price_display = <span class="string">f&quot;¥<span class="subst">&#123;goods[<span class="string">&#x27;price&#x27;</span>]&#125;</span>&quot;</span> <span class="keyword">if</span> goods[<span class="string">&#x27;price&#x27;</span>] != <span class="string">&quot;0&quot;</span> <span class="keyword">else</span> <span class="string">&quot;¥0&quot;</span></span><br><span class="line">        stock_display = goods[<span class="string">&#x27;stock&#x27;</span>]</span><br><span class="line">        sales_display = goods[<span class="string">&#x27;sales&#x27;</span>]</span><br><span class="line">        category_display = goods[<span class="string">&#x27;category&#x27;</span>][:<span class="number">8</span>] <span class="keyword">if</span> <span class="built_in">len</span>(goods[<span class="string">&#x27;category&#x27;</span>]) &gt; <span class="number">8</span> <span class="keyword">else</span> goods[<span class="string">&#x27;category&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;i:&lt;<span class="number">4</span>&#125;</span> <span class="subst">&#123;name:&lt;<span class="number">20</span>&#125;</span> <span class="subst">&#123;price_display:&lt;<span class="number">8</span>&#125;</span> <span class="subst">&#123;stock_display:&lt;<span class="number">6</span>&#125;</span> <span class="subst">&#123;sales_display:&lt;<span class="number">6</span>&#125;</span> <span class="subst">&#123;category_display:&lt;<span class="number">10</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">65</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------------- 5. 主函数 --------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;主函数：执行商品数据提取和转换流程&quot;&quot;&quot;</span></span><br><span class="line">    start_time = time.time()</span><br><span class="line">    logger.info(<span class="string">&quot;=&quot;</span> * <span class="number">50</span> + <span class="string">&quot;开始商品数据提取&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 配置文件路径</span></span><br><span class="line">    burp_xml_path = <span class="string">&quot;burp_requests.xml&quot;</span>  <span class="comment"># Burp导出的XML文件</span></span><br><span class="line">    output_csv_path = <span class="string">&quot;goods_data.csv&quot;</span>  <span class="comment"># 输出的CSV文件</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 执行流程</span></span><br><span class="line">    goods_data = parse_burp_xml_goods(burp_xml_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> goods_data:</span><br><span class="line">        logger.error(<span class="string">&quot;XML解析无有效商品数据，流程终止&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n错误：未提取到商品数据，请检查XML文件格式&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    csv_ok = goods2csv(goods_data, output_csv_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> csv_ok:</span><br><span class="line">        <span class="comment"># 打印提取结果摘要</span></span><br><span class="line">        total_price = <span class="built_in">sum</span>(<span class="built_in">int</span>(goods[<span class="string">&quot;price&quot;</span>]) <span class="keyword">for</span> goods <span class="keyword">in</span> goods_data)</span><br><span class="line">        total_stock = <span class="built_in">sum</span>(<span class="built_in">int</span>(goods[<span class="string">&quot;stock&quot;</span>]) <span class="keyword">for</span> goods <span class="keyword">in</span> goods_data)</span><br><span class="line">        total_sales = <span class="built_in">sum</span>(<span class="built_in">int</span>(goods[<span class="string">&quot;sales&quot;</span>]) <span class="keyword">for</span> goods <span class="keyword">in</span> goods_data)</span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">f&quot;提取完成！&quot;</span>)</span><br><span class="line">        logger.info(<span class="string">f&quot;商品总数：<span class="subst">&#123;<span class="built_in">len</span>(goods_data)&#125;</span>&quot;</span>)</span><br><span class="line">        logger.info(<span class="string">f&quot;总价格：¥<span class="subst">&#123;total_price&#125;</span>&quot;</span>)</span><br><span class="line">        logger.info(<span class="string">f&quot;总库存：<span class="subst">&#123;total_stock&#125;</span>&quot;</span>)</span><br><span class="line">        logger.info(<span class="string">f&quot;总销量：<span class="subst">&#123;total_sales&#125;</span>&quot;</span>)</span><br><span class="line">        logger.info(<span class="string">f&quot;耗时：<span class="subst">&#123;<span class="built_in">round</span>(time.time() - start_time, <span class="number">2</span>)&#125;</span>秒&quot;</span>)</span><br><span class="line">        logger.info(<span class="string">f&quot;输出文件：<span class="subst">&#123;output_csv_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 在控制台以表格形式显示商品信息</span></span><br><span class="line">        display_table(goods_data)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 显示统计信息</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n统计信息:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  商品总数: <span class="subst">&#123;<span class="built_in">len</span>(goods_data)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  总价格: ¥<span class="subst">&#123;total_price&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  总库存: <span class="subst">&#123;total_stock&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;  总销量: <span class="subst">&#123;total_sales&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n完整数据已保存到: <span class="subst">&#123;output_csv_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        logger.error(<span class="string">&quot;商品数据转CSV失败，流程终止&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n错误：CSV转换失败&quot;</span>)</span><br><span class="line"></span><br><span class="line">    logger.info(<span class="string">&quot;=&quot;</span> * <span class="number">50</span> + <span class="string">&quot;商品数据提取结束&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------------- 6. 直接运行 --------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
</li>
<li><p>终端执行：<code>python xml_to_json.py</code>，生成<code>goods_data.csv</code>（含提取的商品数据）。</p>
<p>  验证：打开<code>goods_data.csv</code>，能看到 id、name、price、stock 等字段，包含测试网站的所有商品数据（含异常值）同时还有生成转换日志。</p>
<p>  <img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228231512080.png"></p>
<p>  <img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228231713053.png" alt="转换日志"></p>
</li>
</ul>
<h3 id="MySQL-数据存储（原始-清洗表）"><a href="#MySQL-数据存储（原始-清洗表）" class="headerlink" title="MySQL 数据存储（原始 + 清洗表）"></a>MySQL 数据存储（原始 + 清洗表）</h3><ol>
<li><p>启动 MySQL 服务：</p>
<ul>
<li>右键 “此电脑”→管理→服务，找到<code>MySQL</code>，确保状态为 “正在运行”。</li>
</ul>
</li>
<li><p>Navicat 创建数据库 &#x2F; 表：</p>
<ul>
<li><p>打开 Navicat，连接 MySQL（主机 127.0.0.1，端口 3306，用户名 root，密码自己设置的）。</p>
</li>
<li><p>新建数据库：名称<code>burp_good</code>，字符集<code>utf8mb4</code>，排序规则<code>utf8mb4_general_ci</code>。</p>
</li>
<li><p>新建原始数据表<code>goods_data</code>:</p>
<p>  执行 SQL（Navicat→查询→新建查询）：</p>
  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE burp_good;</span><br><span class="line"><span class="keyword">CREATE TABLE</span> goods_data (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT NULL</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    price <span class="type">INT</span>,</span><br><span class="line">    stock <span class="type">INT</span>,</span><br><span class="line">    category <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    sales <span class="type">INT</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>

<ul>
<li>导入 CSV 数据：右键<code>goods_data</code>→导入向导→选<code>goods_data.csv</code>→字段一一匹配→完成导入。</li>
<li>新建清洗后数据表<code>cleaned_goods_data</code>：结构和<code>goods_data</code>完全一致（复制表结构即可）。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>验证：打开<code>goods_data</code>表，能看到从 CSV 导入的所有商品数据（含异常值），无中文乱码。</p>
<p><img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228232002262.png"></p>
<h3 id="Kettle-数据清洗（过滤无效数据）"><a href="#Kettle-数据清洗（过滤无效数据）" class="headerlink" title="Kettle 数据清洗（过滤无效数据）"></a>Kettle 数据清洗（过滤无效数据）</h3><ol>
<li><p>Kettle 驱动适配（关键！避免编码报错）：</p>
<ul>
<li>下载 MySQL Connector&#x2F;J 8.0.x：<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/connector/j/">https://dev.mysql.com/downloads/connector/j/</a></li>
<li>找到 Kettle 安装目录→<code>lib</code>文件夹，删除旧的<code>mysql-connector-java-*.jar</code>，放入新下载的驱动包。</li>
<li>重启 Kettle。</li>
</ul>
</li>
<li><p>配置 Kettle 清洗转换：</p>
</li>
</ol>
<ul>
<li>启动 Kettle，点击“文件→新建→转换”，在画布中添加以下组件：</li>
<li>表输入组件从“输入”分类中拖拽“表输入”到画布，双击配置：<ul>
<li>选择MySQL连接（已配置的burp_good连接）；</li>
<li>输入 SQL 语句：SELECT * FROM goods_data；</li>
<li>点击“确定”保存。</li>
</ul>
</li>
<li>过滤记录组件从“转换”分类中拖拽“过滤记录”到画布，按住 Shift 从“表输入”拖拽到“过滤记录”，建立连线。</li>
<li>表输出组件从“输出”分类中拖拽“表输出”到画布，按住 Shift 从“过滤记录”的“真”出口拖拽到“表输出”，建立连线，双击配置：<ul>
<li>选择MySQL连接；</li>
<li>选择目标表cleaned_goods_data；</li>
<li>勾选“Truncate table before loading”（导入前清空表）；</li>
<li>点击“确定”保存。</li>
</ul>
</li>
</ul>
<ol start="3">
<li><p>清洗条件配置</p>
<p> 双击“过滤记录”组件，点击“+”按钮逐个添加以下条件（逻辑关系均为“AND”）：</p>
<p> name IS NOT NULL；</p>
<p> name ≠ “”；</p>
<p> category IS NOT NULL；</p>
<p> category ≠ “”；</p>
<p> price IS NOT NULL；</p>
<p> stock IS NOT NULL；</p>
<p> sales IS NOT NULL；</p>
<p> name ≠ “未知”；</p>
<p> category ≠ “未分类”；</p>
<p> stock ＞ 0。添加完成后，设置“发送 true 数据的步骤”为“表输出”，点击“确定”保存</p>
</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228232254214.png"></p>
<p>表输入：读取原始数据表goods_data的所有记录；</p>
<p>过滤记录：配置多条件过滤规则，仅保留符合要求的记录；</p>
<p>表输出：将符合条件的记录写入清洗后数据表cleaned_goods_data.</p>
<p><img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228232422394.png"></p>
<p>注意输出的时候会有肯报错就是输出要设置文字编码，表输出的“数据库连接”的“编辑”，然后选择“选项”，在右侧的命名参数添加。</p>
<p><img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228233001342.png"></p>
<p>清洗结果验证：打开 Navicat 查看cleaned_goods_data表，可看到仅保留了2条有效记录：id&#x3D;1：华为Mate70（stock&#x3D;100&gt;0，category &#x3D; 手机≠未分类）；id&#x3D;4：小米 Pad6（stock&#x3D;200&gt;0，category &#x3D; 平板≠未分类）。验证清洗规则生效，无效数据已被过滤。</p>
<p><img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228233111363.png"></p>
<h3 id="数据可视化（生成图表）"><a href="#数据可视化（生成图表）" class="headerlink" title="数据可视化（生成图表）"></a>数据可视化（生成图表）</h3><ol>
<li><p>准备可视化脚本：</p>
<ul>
<li><p>将<code>visualize.py</code>复制到<code>burp_test_site</code>文件夹。</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> rcParams</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置中文显示</span></span><br><span class="line">rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]  <span class="comment"># Windows</span></span><br><span class="line"><span class="comment"># rcParams[&#x27;font.sans-serif&#x27;] = [&#x27;PingFang SC&#x27;]  # macOS</span></span><br><span class="line">rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接MySQL读取清洗后的数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_clean_data</span>():</span><br><span class="line">    conn = pymysql.connect(</span><br><span class="line">        host=<span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        port=<span class="number">3306</span>,</span><br><span class="line">        user=<span class="string">&quot;root&quot;</span>,</span><br><span class="line">        password=<span class="string">&quot;123456&quot;</span>,</span><br><span class="line">        database=<span class="string">&quot;burp_good&quot;</span>,</span><br><span class="line">        charset=<span class="string">&quot;utf8mb4&quot;</span>,  <span class="comment"># 匹配数据库的字符集</span></span><br><span class="line">        use_unicode=<span class="literal">True</span>  <span class="comment"># 强制使用Unicode编码处理字符串</span></span><br><span class="line">    )</span><br><span class="line">    df = pd.read_sql(<span class="string">&quot;SELECT * FROM cleaned_goods_data&quot;</span>, conn)</span><br><span class="line">    conn.close()</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化示例：商品价格分布</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plot_goods_price</span>(<span class="params">df</span>):</span><br><span class="line">    <span class="comment"># 筛选商品数据</span></span><br><span class="line">    goods_df = df[df[<span class="string">&quot;id&quot;</span>].notna()]</span><br><span class="line">    <span class="comment"># 柱状图</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">    plt.bar(goods_df[<span class="string">&quot;name&quot;</span>], goods_df[<span class="string">&quot;price&quot;</span>], color=<span class="string">&quot;#007bff&quot;</span>)</span><br><span class="line">    plt.title(<span class="string">&quot;商品价格分布&quot;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&quot;商品名称&quot;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&quot;价格（元）&quot;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">    plt.grid(axis=<span class="string">&quot;y&quot;</span>, linestyle=<span class="string">&quot;--&quot;</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">    plt.savefig(<span class="string">&quot;goods_price.png&quot;</span>, dpi=<span class="number">300</span>, bbox_inches=<span class="string">&quot;tight&quot;</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    df = get_clean_data()</span><br><span class="line">    plot_goods_price(df)</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改脚本中的 MySQL 连接参数：<code>password</code>改为自己的 MySQL 密码，其他（host&#x2F;port&#x2F;user&#x2F;database）默认即可。</p>
</li>
</ul>
</li>
<li><p>运行脚本：</p>
<ul>
<li>在<code>burp_data</code>虚拟环境下，终端执行：<code>python visualize.py</code>。</li>
</ul>
</li>
</ol>
<p>验证：</p>
<ul>
<li><p>自动弹出 “商品价格分布” 柱状图，中文标签正常显示，数据为清洗后的有效商品；</p>
</li>
<li><p>文件夹中生成<code>goods_price.png</code>高清图表文件。</p>
<p>  <img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228233353425.png"></p>
<p>  <img src="https://cdn.jsdelivr.net/gh/tangxtang1119/ImageBed@main/image/20251228233420190.png"></p>
</li>
</ul>
<h3 id="收尾与验证（全流程确认）"><a href="#收尾与验证（全流程确认）" class="headerlink" title="收尾与验证（全流程确认）"></a>收尾与验证（全流程确认）</h3><p>文档：整理课题报告（含引言、需求分析、方案设计、实施、评估、总结、参考文献、附录）为 PDF；</p>
<p>代码：<code>app.py</code>&#x2F;<code>visualize.py</code>&#x2F;<code>xml_to_json.py</code>&#x2F;<code>index.html</code>；</p>
<p>数据：<code>burp_requests.xml</code>（抓包）、<code>goods_data.csv</code>（解析）、MySQL 两张表的备份（Navicat→右键表→转储 SQL 文件）；</p>
<p>成果：<code>goods_price.png</code>（可视化图表）、各环节关键截图（网站页面、Burp 抓包、Kettle 清洗、可视化图表）。</p>
<p>打包：按 “文档 &#x2F; 代码 &#x2F; 环境配置 &#x2F; 测试数据 &#x2F; 成果展示” 分类整理文件夹，压缩为<code>课题名称-姓名-学号.zip</code>。</p>
<h3 id="核心注意事项"><a href="#核心注意事项" class="headerlink" title="核心注意事项"></a>核心注意事项</h3><ol>
<li>编码问题：MySQL 字符集必须设为<code>utf8mb4</code>，Kettle 驱动升级到 8.0.x，可视化脚本配置中文字体；</li>
<li>字段匹配：可视化脚本的字段名（id&#x2F;name&#x2F;price）必须和 MySQL 表字段一致；</li>
<li>环境激活：所有脚本运行前，确保激活<code>burp_data</code>虚拟环境，避免依赖找不到；</li>
<li>代理配置：Burp 仅勾选 “Loopback only”，避免抓取非本地请求。</li>
<li>清洗的表输出要设置文字编码。</li>
<li>保证kettle全流程的数据库连接完成。</li>
</ol>
<h3 id="流程总结"><a href="#流程总结" class="headerlink" title="流程总结"></a>流程总结</h3><p>本流程核心是 “搭建数据源→采集数据→存储数据→清洗数据→可视化展示” 的闭环，关键在于：</p>
<ol>
<li><p>环境隔离（虚拟环境）避免依赖冲突；</p>
</li>
<li><p>驱动 &#x2F; 编码适配解决工具兼容问题；</p>
</li>
<li><p>规则化清洗确保数据有效性；</p>
</li>
<li><p>字段 &#x2F; 表名统一避免可视化报错。</p>
<p> 按步骤执行可完整复现从 “本地网站→数据→图表” 的全流程</p>
</li>
</ol>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>版权声明： </strong>
          
          本博客所有文章除特别声明外，著作权归作者所有。转载请注明出处！
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://tangxtang1119.github.io/2025/12/28/%E5%9F%BA%E4%BA%8EBurp%E7%9A%84%E7%BD%91%E7%AB%99%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86%E5%8F%8A%E5%8F%AF%E8%A7%86%E5%8C%96/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E4%BD%9C%E4%B8%9A/" rel="tag">作业</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
    
      <a href="/2025/11/21/BadNets%E3%80%81%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%90%8E%E9%97%A8%E6%94%BB%E5%87%BB%E3%80%81%E6%95%B0%E6%8D%AE%E6%8A%95%E6%AF%92%E6%94%BB%E5%87%BB%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">基于BadNets的神经网络后门攻击仿真系统设计与实现（一）</div>
      </a>
    
  </nav>

   
 
   
  
   
    <script src="https://cdn.staticfile.org/twikoo/1.4.18/twikoo.all.min.js"></script>
    <div id="twikoo" class="twikoo"></div>
    <script>
        twikoo.init({
            envId: ""
        })
    </script>
 
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2025
        <i class="ri-heart-fill heart_icon"></i> 唐小唐
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/yuhangyuan.ico" alt="tangxtang"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i></p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=2658106011&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
    

  </div>
</body>

</html>